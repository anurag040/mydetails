<div class="statistics-dashboard" *ngIf="currentDataset">
  <!-- Header Section -->
  <mat-card class="header-card">
    <mat-card-header>
      <mat-icon mat-card-avatar>analytics</mat-icon>
      <mat-card-title>Statistical Analysis</mat-card-title>
      <mat-card-subtitle>{{ currentDataset.filename }} • {{ currentDataset.rows }} rows × {{ currentDataset.columns }} columns</mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      <div class="analysis-type-indicator" *ngIf="selectedAnalysisType">
        <mat-chip [color]="selectedAnalysisType === 'basic' ? 'primary' : 'accent'" selected>
          <mat-icon>{{ selectedAnalysisType === 'basic' ? 'analytics' : 'science' }}</mat-icon>
          {{ selectedAnalysisType === 'basic' ? 'Basic Analysis' : 'Advanced Analysis' }}
        </mat-chip>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- AI-Powered Quick Summary -->
  <mat-card class="summary-card" *ngIf="quickSummary">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>psychology</mat-icon>
        AI-Powered Dataset Insights
      </mat-card-title>
      <mat-card-subtitle>Intelligent analysis of your data characteristics</mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      <div class="ai-insights-container">
        <div class="insight-card" *ngFor="let insight of getAIInsights()">
          <div class="insight-header">
            <mat-icon [ngClass]="'insight-icon-' + insight.color">{{ insight.icon }}</mat-icon>
            <h4 class="insight-title">{{ insight.title }}</h4>
          </div>
          <p class="insight-description">{{ insight.description }}</p>
        </div>
        
        <!-- Raw Data Toggle (for advanced users) -->
        <mat-expansion-panel class="raw-data-panel">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <mat-icon>code</mat-icon>
              Technical Details
            </mat-panel-title>
            <mat-panel-description>
              View raw data metrics for advanced analysis
            </mat-panel-description>
          </mat-expansion-panel-header>
          
          <div class="summary-grid">
            <div class="summary-item" *ngFor="let item of getSummaryEntries()">
              <span class="summary-label">{{ formatKeyName(item.key) }}</span>
              <span class="summary-value">{{ formatSummaryValue(item.value) }}</span>
            </div>
          </div>
        </mat-expansion-panel>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Analysis Tabs -->
  <mat-tab-group>
    <!-- Basic Statistics Tab -->
    <mat-tab label="Basic Statistics">
      <div class="tab-content">
        <!-- Data Source & Schema Overview -->
        <mat-card class="data-source-card" *ngIf="quickSummary">
          <mat-card-header>
            <mat-card-title>
              <mat-icon>source</mat-icon>
              Data Source & Schema Overview
            </mat-card-title>
            <mat-card-subtitle>Comprehensive data structure and quality assessment</mat-card-subtitle>
          </mat-card-header>
          
          <mat-card-content>
            <!-- File Information Summary -->
            <div class="file-info-section">
              <h3>
                <mat-icon>description</mat-icon>
                File Information
              </h3>
              
              <div class="info-grid">
                <div class="info-item">
                  <span class="info-label">Dataset Size:</span>
                  <span class="info-value highlight">{{ quickSummary.shape?.rows | number }} rows × {{ quickSummary.shape?.columns | number }} columns</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Memory Usage:</span>
                  <span class="info-value">{{ quickSummary.memory_usage }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Missing Data:</span>
                  <span class="info-value" [ngClass]="{'warning': quickSummary.missing_data?.percentage > 10}">
                    {{ quickSummary.missing_data?.total_missing | number }} cells ({{ quickSummary.missing_data?.percentage | number:'1.2-2' }}%)
                  </span>
                </div>
                <div class="info-item">
                  <span class="info-label">Duplicate Rows:</span>
                  <span class="info-value" [ngClass]="{'warning': quickSummary.file_info?.duplicate_rows > 0}">
                    {{ quickSummary.file_info?.duplicate_rows | number }}
                  </span>
                </div>
              </div>
            </div>

            <!-- Column Type Distribution -->
            <div class="column-types-section">
              <h3>
                <mat-icon>view_column</mat-icon>
                Column Type Distribution
              </h3>
              
              <div class="type-chips">
                <mat-chip-listbox>
                  <mat-chip-option color="primary" *ngIf="quickSummary.column_types?.numeric > 0">
                    <mat-icon>123</mat-icon>
                    Numeric: {{ quickSummary.column_types.numeric }}
                  </mat-chip-option>
                  <mat-chip-option color="accent" *ngIf="quickSummary.column_types?.categorical > 0">
                    <mat-icon>category</mat-icon>
                    Categorical: {{ quickSummary.column_types.categorical }}
                  </mat-chip-option>
                  <mat-chip-option color="warn" *ngIf="quickSummary.column_types?.datetime > 0">
                    <mat-icon>schedule</mat-icon>
                    DateTime: {{ quickSummary.column_types.datetime }}
                  </mat-chip-option>
                </mat-chip-listbox>
              </div>
            </div>

            <!-- Schema Details (Expandable) -->
            <mat-expansion-panel class="schema-panel">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon>table_view</mat-icon>
                  Detailed Schema Information
                </mat-panel-title>
                <mat-panel-description>
                  Column-by-column data type and quality metrics
                </mat-panel-description>
              </mat-expansion-panel-header>
              
              <div class="schema-table-container">
                <table mat-table [dataSource]="getSchemaTableData()" class="schema-table">
                  <ng-container matColumnDef="column">
                    <th mat-header-cell *matHeaderCellDef>Column Name</th>
                    <td mat-cell *matCellDef="let element">
                      <strong>{{ element.name }}</strong>
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="type">
                    <th mat-header-cell *matHeaderCellDef>Data Type</th>
                    <td mat-cell *matCellDef="let element">
                      <mat-chip [color]="getTypeColor(element.type)" selected>
                        {{ element.type }}
                      </mat-chip>
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="missing">
                    <th mat-header-cell *matHeaderCellDef>Missing</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.null_count | number }} ({{ element.null_percentage | number:'1.1-1' }}%)
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="unique">
                    <th mat-header-cell *matHeaderCellDef>Unique Values</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.unique_count | number }} ({{ element.unique_percentage | number:'1.1-1' }}%)
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="memory">
                    <th mat-header-cell *matHeaderCellDef>Memory (KB)</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.memory_usage | number:'1.1-1' }}
                    </td>
                  </ng-container>

                  <tr mat-header-row *matHeaderRowDef="['column', 'type', 'missing', 'unique', 'memory']"></tr>
                  <tr mat-row *matRowDef="let row; columns: ['column', 'type', 'missing', 'unique', 'memory'];"></tr>
                </table>
              </div>
            </mat-expansion-panel>

            <!-- Sample Data Preview -->
            <mat-expansion-panel class="sample-panel">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon>preview</mat-icon>
                  Sample Data Preview
                </mat-panel-title>
                <mat-panel-description>
                  First, last, and random sample rows from your dataset
                </mat-panel-description>
              </mat-expansion-panel-header>
              
              <div class="sample-tabs">
                <mat-tab-group>
                  <mat-tab label="First 5 Rows">
                    <div class="sample-table-container">
                      <table mat-table [dataSource]="quickSummary.sample_preview?.head || []" class="sample-table">
                        <ng-container *ngFor="let col of getPreviewColumns()" [matColumnDef]="col">
                          <th mat-header-cell *matHeaderCellDef>{{ col }}</th>
                          <td mat-cell *matCellDef="let element">{{ formatCellValue(element[col]) }}</td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="getPreviewColumns()"></tr>
                        <tr mat-row *matRowDef="let row; columns: getPreviewColumns();"></tr>
                      </table>
                    </div>
                  </mat-tab>
                  
                  <mat-tab label="Last 5 Rows">
                    <div class="sample-table-container">
                      <table mat-table [dataSource]="quickSummary.sample_preview?.tail || []" class="sample-table">
                        <ng-container *ngFor="let col of getPreviewColumns()" [matColumnDef]="col">
                          <th mat-header-cell *matHeaderCellDef>{{ col }}</th>
                          <td mat-cell *matCellDef="let element">{{ formatCellValue(element[col]) }}</td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="getPreviewColumns()"></tr>
                        <tr mat-row *matRowDef="let row; columns: getPreviewColumns();"></tr>
                      </table>
                    </div>
                  </mat-tab>
                  
                  <mat-tab label="Random Sample" *ngIf="quickSummary.sample_preview?.random_sample?.length > 0">
                    <div class="sample-table-container">
                      <table mat-table [dataSource]="quickSummary.sample_preview?.random_sample || []" class="sample-table">
                        <ng-container *ngFor="let col of getPreviewColumns()" [matColumnDef]="col">
                          <th mat-header-cell *matHeaderCellDef>{{ col }}</th>
                          <td mat-cell *matCellDef="let element">{{ formatCellValue(element[col]) }}</td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="getPreviewColumns()"></tr>
                        <tr mat-row *matRowDef="let row; columns: getPreviewColumns();"></tr>
                      </table>
                    </div>
                  </mat-tab>
                </mat-tab-group>
              </div>
            </mat-expansion-panel>
          </mat-card-content>
        </mat-card>

        <!-- Options Selection -->
        <mat-card class="options-card">
          <mat-card-header>
            <mat-card-title>Analysis Options</mat-card-title>
            <mat-card-subtitle>Select the statistical analyses to perform</mat-card-subtitle>
          </mat-card-header>
          
          <mat-card-content>
            <div class="options-grid">
              <mat-checkbox 
                *ngFor="let option of basicOptions" 
                [(ngModel)]="option.selected"
                class="option-checkbox">
                <div class="option-content">
                  <span class="option-name">{{ option.name }}</span>
                  <span class="option-description">{{ option.description }}</span>
                </div>
              </mat-checkbox>
            </div>
          </mat-card-content>
          
          <mat-card-actions>
            <button mat-raised-button 
                    color="primary" 
                    (click)="calculateBasicStatistics()"
                    [disabled]="isLoading">
              <mat-icon>calculate</mat-icon>
              Calculate Basic Statistics
            </button>
            
            <mat-spinner *ngIf="isLoading" diameter="24" class="inline-spinner"></mat-spinner>
          </mat-card-actions>
        </mat-card>

        <!-- Basic Results -->
        <div class="results-section" *ngIf="basicResults">
          <!-- Descriptive Statistics -->
          <mat-card *ngIf="basicResults.descriptive_stats" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>bar_chart</mat-icon>
                Descriptive Statistics & AI Insights
              </mat-card-title>
              <mat-card-subtitle>
                Statistical summary with intelligent analysis and business implications
              </mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- AI-Driven Insights Section -->
              <div class="insights-section" *ngIf="getDescriptiveInsights().length > 0">
                <h3 class="insights-title">
                  <mat-icon>psychology</mat-icon>
                  AI-Powered Statistical Insights
                </h3>
                
                <div class="insights-grid">
                  <div *ngFor="let insight of getDescriptiveInsights()" class="insight-card">
                    <div class="insight-header">
                      <h4>{{ insight.column }}</h4>
                      <mat-icon>trending_up</mat-icon>
                    </div>
                    
                    <div class="insight-content">
                      <div class="insight-item">
                        <strong>Distribution:</strong>
                        <span [innerHTML]="insight.dataDistribution"></span>
                      </div>
                      
                      <div class="insight-item">
                        <strong>Variability:</strong>
                        <span [innerHTML]="insight.variability"></span>
                      </div>
                      
                      <div class="insight-item">
                        <strong>Data Quality:</strong>
                        <span [innerHTML]="insight.outlierRisk"></span>
                      </div>
                      
                      <div class="insight-item business-insight">
                        <strong>Business Impact:</strong>
                        <span [innerHTML]="insight.businessImplication"></span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Technical Statistics Table -->
              <div class="technical-section">
                <h3 class="technical-title">
                  <mat-icon>analytics</mat-icon>
                  Technical Statistics
                </h3>
                
                <div class="table-container">
                  <table mat-table [dataSource]="getDescriptiveStatsKeys()" class="descriptive-table">
                    <ng-container matColumnDef="column">
                      <th mat-header-cell *matHeaderCellDef>Column</th>
                      <td mat-cell *matCellDef="let column">
                        <strong>{{ column }}</strong>
                      </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="count">
                      <th mat-header-cell *matHeaderCellDef>Count</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.count) }}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="mean">
                      <th mat-header-cell *matHeaderCellDef>Mean</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.mean) }}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="median">
                      <th mat-header-cell *matHeaderCellDef>Median</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.['50%']) }}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="std">
                      <th mat-header-cell *matHeaderCellDef>Std Dev</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.std) }}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="min">
                      <th mat-header-cell *matHeaderCellDef>Min</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.min) }}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="q25">
                      <th mat-header-cell *matHeaderCellDef>Q1 (25%)</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.['25%']) }}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="q75">
                      <th mat-header-cell *matHeaderCellDef>Q3 (75%)</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.['75%']) }}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="max">
                      <th mat-header-cell *matHeaderCellDef>Max</th>
                      <td mat-cell *matCellDef="let column">{{ formatNumber(getDescriptiveStatsData()[column]?.max) }}</td>
                    </ng-container>
                    
                    <tr mat-header-row *matHeaderRowDef="['column', 'count', 'mean', 'median', 'std', 'min', 'q25', 'q75', 'max']"></tr>
                    <tr mat-row *matRowDef="let row; columns: ['column', 'count', 'mean', 'median', 'std', 'min', 'q25', 'q75', 'max']"></tr>
                  </table>
                </div>

                <!-- Advanced Metrics with Enhanced Layout -->
                <div class="additional-stats" *ngIf="getAdditionalStatsData() && getObjectKeys(getAdditionalStatsData()).length > 0">
                  <h4>
                    <mat-icon>analytics</mat-icon>
                    Advanced Statistical Metrics
                  </h4>
                  <div class="advanced-metrics-grid">
                    <div *ngFor="let column of getDescriptiveStatsKeys()" class="metric-card">
                      <h5>{{ column }}</h5>
                      <div class="metric-row">
                        <span class="metric-label">Variance</span>
                        <span class="metric-value">{{ formatNumber(getAdditionalStatsData()[column]?.variance) }}</span>
                      </div>
                      <div class="metric-row">
                        <span class="metric-label">Coefficient of Variation</span>
                        <span class="metric-value">{{ formatNumber(getAdditionalStatsData()[column]?.coefficient_of_variation) }}</span>
                      </div>
                      <div class="metric-row">
                        <span class="metric-label">Range</span>
                        <span class="metric-value">{{ formatNumber(getAdditionalStatsData()[column]?.range) }}</span>
                      </div>
                      <div class="metric-row">
                        <span class="metric-label">Interquartile Range (IQR)</span>
                        <span class="metric-value">{{ calculateIQR(column) }}</span>
                      </div>
                      <div class="metric-row">
                        <span class="metric-label">Skewness</span>
                        <span class="metric-value">{{ getSkewnessLabel(column) }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Correlation Analysis -->
          <mat-card *ngIf="basicResults.correlation_matrix" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>device_hub</mat-icon>
                Correlation Analysis & Relationship Insights
              </mat-card-title>
              <mat-card-subtitle>
                Discover relationships between variables with AI-powered insights and interactive visualizations
              </mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- AI-Driven Correlation Insights -->
              <div class="correlation-insights" *ngIf="getCorrelationInsights().length > 0">
                <h3 class="insights-title">
                  <mat-icon>psychology</mat-icon>
                  Relationship Intelligence
                </h3>
                
                <div class="insights-grid">
                  <div *ngFor="let insight of getCorrelationInsights()" class="insight-card">
                    <div class="insight-header">
                      <mat-icon [ngClass]="'insight-icon-' + insight.color">{{ insight.icon }}</mat-icon>
                      <h4>{{ insight.title }}</h4>
                    </div>
                    <p class="insight-description">{{ insight.description }}</p>
                  </div>
                </div>
              </div>

              <!-- Correlation Heatmap Visualization -->
              <div class="heatmap-section" *ngIf="getHeatmapVariables().length > 1">
                <h3 class="section-title">
                  <mat-icon>grid_on</mat-icon>
                  Interactive Correlation Heatmap
                </h3>
                <p class="section-description">
                  Visual correlation matrix showing relationships between variables. 
                  <strong>Green</strong> indicates positive correlation, <strong>Orange</strong> indicates negative correlation.
                </p>
                
                <!-- Chart.js Heatmap -->
                <div class="heatmap-chart-container">
                  <canvas 
                    #correlationHeatmap
                    baseChart
                    *ngIf="getCorrelationHeatmapData()"
                    [data]="getCorrelationHeatmapData()!"
                    [options]="heatmapChartOptions"
                    [type]="'scatter'"
                    [width]="600"
                    [height]="400">
                  </canvas>
                  
                  <!-- Fallback: Custom Grid Heatmap -->
                  <div *ngIf="!getCorrelationHeatmapData()" class="custom-heatmap-container">
                    <div class="heatmap-grid" 
                         [style.grid-template-columns]="'120px repeat(' + getHeatmapVariables().length + ', minmax(60px, 1fr))'">
                      <!-- Empty corner cell -->
                      <div class="heatmap-corner"></div>
                      
                      <!-- Column Headers -->
                      <div class="heatmap-header" *ngFor="let variable of getHeatmapVariables()">
                        {{ variable }}
                      </div>
                      
                      <!-- Row Headers and Heatmap Cells -->
                      <ng-container *ngFor="let rowVar of getHeatmapVariables()">
                        <!-- Row Header -->
                        <div class="heatmap-row-header">{{ rowVar }}</div>
                        
                        <!-- Correlation Cells for this row -->
                        <div *ngFor="let colVar of getHeatmapVariables()" 
                             class="heatmap-cell"
                             [style.background-color]="getHeatmapColor(rowVar, colVar)"
                             [title]="rowVar + ' ↔ ' + colVar + ': ' + formatNumber(getCorrelationValue(rowVar, colVar))">
                          <span class="cell-value">{{ formatNumber(getCorrelationValue(rowVar, colVar)) }}</span>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>
                
                <!-- Heatmap Legend -->
                <div class="heatmap-legend">
                  <div class="legend-item">
                    <div class="legend-color" style="background: #ff6600;"></div>
                    <span>Strong Negative (-1.0 to -0.7)</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background: #ffb74d;"></div>
                    <span>Weak Negative (-0.7 to 0)</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background: #c8e6c9;"></div>
                    <span>Weak Positive (0 to 0.7)</span>
                  </div>
                  <div class="legend-item">
                    <div class="legend-color" style="background: #00ff88;"></div>
                    <span>Strong Positive (0.7 to 1.0)</span>
                  </div>
                </div>
              </div>

              <!-- Interactive Correlation Matrix -->
              <div class="correlation-matrix-section" *ngIf="getCorrelationMatrixEntries().length > 0">
                <h3 class="section-title">
                  <mat-icon>table_chart</mat-icon>
                  Detailed Correlation Matrix
                </h3>
                
                <div class="matrix-table-container">
                  <table mat-table [dataSource]="getCorrelationMatrixEntries()" class="correlation-table">
                    <ng-container matColumnDef="variables">
                      <th mat-header-cell *matHeaderCellDef>Variable Pair</th>
                      <td mat-cell *matCellDef="let element">
                        <div class="variable-pair">
                          <strong>{{ element.var1 }}</strong>
                          <mat-icon>arrow_right_alt</mat-icon>
                          <strong>{{ element.var2 }}</strong>
                        </div>
                      </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="correlation">
                      <th mat-header-cell *matHeaderCellDef>Correlation</th>
                      <td mat-cell *matCellDef="let element">
                        <div class="correlation-value" 
                             [ngClass]="{'positive': element.correlation > 0, 'negative': element.correlation < 0}">
                          {{ formatNumber(element.correlation) }}
                        </div>
                      </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="strength">
                      <th mat-header-cell *matHeaderCellDef>Strength</th>
                      <td mat-cell *matCellDef="let element">
                        <mat-chip [color]="element.strength === 'Very Strong' || element.strength === 'Strong' ? 'warn' : 'primary'">
                          {{ element.strength }}
                        </mat-chip>
                      </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="interpretation">
                      <th mat-header-cell *matHeaderCellDef>Business Interpretation</th>
                      <td mat-cell *matCellDef="let element">
                        <div class="interpretation-text">
                          {{ element.interpretation }}
                        </div>
                      </td>
                    </ng-container>
                    
                    <tr mat-header-row *matHeaderRowDef="['variables', 'correlation', 'strength', 'interpretation']"></tr>
                    <tr mat-row *matRowDef="let row; columns: ['variables', 'correlation', 'strength', 'interpretation']"></tr>
                  </table>
                </div>
              </div>

              <!-- Strong Correlations Summary -->
              <div class="strong-correlations-section" *ngIf="getCorrelationPairs().length > 0">
                <h3 class="section-title">
                  <mat-icon>link</mat-icon>
                  Key Relationships (|r| ≥ 0.7)
                </h3>
                
                <div class="strong-correlations-grid">
                  <div *ngFor="let pair of getCorrelationPairs()" class="correlation-card">
                    <div class="correlation-header">
                      <div class="variable-names">
                        <span class="var1">{{ pair.var1 }}</span>
                        <mat-icon>{{ pair.correlation > 0 ? 'trending_up' : 'trending_down' }}</mat-icon>
                        <span class="var2">{{ pair.var2 }}</span>
                      </div>
                      <div class="correlation-badge" 
                           [ngClass]="{'positive': pair.correlation > 0, 'negative': pair.correlation < 0}">
                        {{ formatNumber(pair.correlation) }}
                      </div>
                    </div>
                    
                    <div class="correlation-description">
                      <p><strong>{{ pair.strength | titlecase }}</strong> correlation indicates:</p>
                      <ul>
                        <li *ngIf="pair.correlation > 0">These variables move together in the same direction</li>
                        <li *ngIf="pair.correlation < 0">These variables move in opposite directions</li>
                        <li>{{ (abs(pair.correlation) * 100).toFixed(1) }}% of variation is shared</li>
                        <li *ngIf="abs(pair.correlation) > 0.8">Consider potential multicollinearity</li>
                        <li *ngIf="abs(pair.correlation) > 0.7 && abs(pair.correlation) <= 0.8">Strong predictive relationship</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              <!-- No Strong Correlations Message -->
              <div class="no-correlations" *ngIf="getCorrelationPairs().length === 0 && getCorrelationMatrixEntries().length > 0">
                <div class="info-card">
                  <mat-icon>info</mat-icon>
                  <div class="info-content">
                    <h4>No Strong Correlations Detected</h4>
                    <p>All correlations are below 0.7, indicating that variables are relatively independent. This suggests:</p>
                    <ul>
                      <li>Good feature diversity for machine learning models</li>
                      <li>Lower risk of multicollinearity</li>
                      <li>Each variable contributes unique information</li>
                    </ul>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Distribution Analysis with Visualizations -->
          <mat-card *ngIf="basicResults.distribution_analysis" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>show_chart</mat-icon>
                Data Distribution Analysis & Visualizations
              </mat-card-title>
              <mat-card-subtitle>
                Statistical distribution patterns and visual analysis for each numeric column
              </mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <div class="distribution-content">
                <!-- AI-Driven Distribution Insights -->
                <div class="insights-section" *ngIf="getDistributionInsights().length > 0">
                  <h3 class="insights-title">
                    <mat-icon>psychology</mat-icon>
                    Distribution Intelligence
                  </h3>
                  
                  <div class="insights-grid">
                    <div *ngFor="let insight of getDistributionInsights()" class="insight-card">
                      <div class="insight-header">
                        <mat-icon [ngClass]="'insight-icon-' + insight.color">{{ insight.icon }}</mat-icon>
                        <h4>{{ insight.title }}</h4>
                      </div>
                      <p class="insight-description">{{ insight.description }}</p>
                    </div>
                  </div>
                </div>

                <!-- Visual Distribution Cards -->
                <div class="distribution-grid">
                  <div *ngFor="let column of getNumericColumns()" class="distribution-card">
                    <h4>
                      <mat-icon>bar_chart</mat-icon>
                      {{ column }} Distribution
                    </h4>
                    
                    <!-- Real Chart.js Histogram -->
                    <div class="chart-container">
                      <canvas 
                        #distributionChart
                        baseChart
                        *ngIf="getHistogramData(column)"
                        [data]="getHistogramData(column)!"
                        [options]="chartOptions"
                        [type]="'bar'"
                        [width]="400"
                        [height]="200">
                      </canvas>
                      
                      <!-- Fallback message if no data -->
                      <div *ngIf="!getHistogramData(column)" class="no-chart-data">
                        <mat-icon>info</mat-icon>
                        <p>No histogram data available for {{ column }}</p>
                      </div>
                    </div>
                    
                    <!-- Distribution Statistics -->
                    <div class="distribution-stats">
                      <div class="stat-row">
                        <span class="stat-label">Shape</span>
                        <span class="stat-value">{{ getDistributionShape(column) }}</span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-label">Symmetry</span>
                        <span class="stat-value">{{ getDistributionSymmetry(column) }}</span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-label">Outlier Risk</span>
                        <span class="stat-value">{{ getOutlierRisk(column) }}</span>
                      </div>
                      <div class="stat-row">
                        <span class="stat-label">Data Quality</span>
                        <span class="stat-value">{{ getDataQuality(column) }}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Technical Distribution Details -->
                <div class="technical-section">
                  <h3 class="technical-title">
                    <mat-icon>code</mat-icon>
                    Distribution Summary
                  </h3>
                  
                  <div class="distribution-summary-grid">
                    <div *ngFor="let column of getNumericColumns()" class="distribution-summary-card">
                      <h4>{{ column }}</h4>
                      <div class="summary-stats">
                        <div class="stat-row">
                          <span class="stat-label">Skewness:</span>
                          <span class="stat-value">{{ formatNumber(basicResults.distribution_analysis?.histograms?.[column]?.skewness) }}</span>
                        </div>
                        <div class="stat-row">
                          <span class="stat-label">Kurtosis:</span>
                          <span class="stat-value">{{ formatNumber(basicResults.distribution_analysis?.histograms?.[column]?.kurtosis) }}</span>
                        </div>
                        <div class="stat-row">
                          <span class="stat-label">Distribution Type:</span>
                          <span class="stat-value">{{ basicResults.distribution_analysis?.histograms?.[column]?.distribution_type || 'Unknown' }}</span>
                        </div>
                        <div class="stat-row">
                          <span class="stat-label">Bins Count:</span>
                          <span class="stat-value">{{ basicResults.distribution_analysis?.histograms?.[column]?.bins?.length || 0 }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Missing Data Analysis -->
          <mat-card *ngIf="basicResults.missing_data_summary" class="result-card missing-data-overview-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>visibility_off</mat-icon>
                Data Completeness Overview
              </mat-card-title>
              <mat-card-subtitle>Quick assessment of missing values and data completeness</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <div class="missing-data-overview">
                <!-- Data Completeness Score -->
                <div class="completeness-score-section">
                  <div class="score-display">
                    <div class="score-circle" [ngClass]="getCompletenessScoreClass(basicResults.missing_data_summary?.complete_rows_percentage || 0)">
                      <span class="score-value">{{ basicResults.missing_data_summary?.complete_rows_percentage || 0 | number:'1.0-0' }}%</span>
                      <span class="score-label">Complete</span>
                    </div>
                  </div>
                  
                  <div class="completeness-details">
                    <h4>Data Quality Assessment</h4>
                    <p class="assessment-text" [ngClass]="getCompletenessTextClass(basicResults.missing_data_summary?.complete_rows_percentage || 0)">
                      {{ getCompletenessAssessment(basicResults.missing_data_summary?.complete_rows_percentage || 0) }}
                    </p>
                  </div>
                </div>

                <!-- Key Metrics Grid -->
                <div class="missing-metrics-grid">
                  <div class="metric-card total-missing">
                    <div class="metric-icon">
                      <mat-icon>error_outline</mat-icon>
                    </div>
                    <div class="metric-content">
                      <span class="metric-value" [ngClass]="{'critical': (basicResults.missing_data_summary?.total_missing || 0) > 1000}">
                        {{ basicResults.missing_data_summary?.total_missing || 0 | number }}
                      </span>
                      <span class="metric-label">Missing Values</span>
                      <div class="metric-bar">
                        <div class="metric-fill missing-fill" [style.width.%]="basicResults.missing_data_summary?.total_percentage || 0"></div>
                      </div>
                      <span class="metric-percentage">{{ basicResults.missing_data_summary?.total_percentage || 0 | number:'1.1-1' }}%</span>
                    </div>
                  </div>

                  <div class="metric-card complete-rows">
                    <div class="metric-icon">
                      <mat-icon>check_circle</mat-icon>
                    </div>
                    <div class="metric-content">
                      <span class="metric-value success">
                        {{ basicResults.missing_data_summary?.complete_rows || 0 | number }}
                      </span>
                      <span class="metric-label">Complete Rows</span>
                      <div class="metric-bar">
                        <div class="metric-fill complete-fill" [style.width.%]="basicResults.missing_data_summary?.complete_rows_percentage || 0"></div>
                      </div>
                      <span class="metric-percentage">{{ basicResults.missing_data_summary?.complete_rows_percentage || 0 | number:'1.1-1' }}%</span>
                    </div>
                  </div>

                  <div class="metric-card data-usability">
                    <div class="metric-icon">
                      <mat-icon>analytics</mat-icon>
                    </div>
                    <div class="metric-content">
                      <span class="metric-value" [ngClass]="getUsabilityClass(basicResults.missing_data_summary?.complete_rows_percentage || 0)">
                        {{ getUsabilityRating(basicResults.missing_data_summary?.complete_rows_percentage || 0) }}
                      </span>
                      <span class="metric-label">Data Usability</span>
                      <div class="usability-indicator">
                        <mat-icon [ngClass]="getUsabilityIconClass(basicResults.missing_data_summary?.complete_rows_percentage || 0)">
                          {{ getUsabilityIcon(basicResults.missing_data_summary?.complete_rows_percentage || 0) }}
                        </mat-icon>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Quick Insights -->
                <div class="quick-insights" *ngIf="getQuickMissingInsights(basicResults.missing_data_summary).length > 0">
                  <h4>
                    <mat-icon>insights</mat-icon>
                    Quick Insights
                  </h4>
                  <div class="insights-list">
                    <div *ngFor="let insight of getQuickMissingInsights(basicResults.missing_data_summary)" class="insight-item">
                      <mat-icon [ngClass]="insight.type">{{ insight.icon }}</mat-icon>
                      <span>{{ insight.message }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Missing Value Report & Strategy -->
          <mat-card *ngIf="basicResults.missing_value_analysis" class="result-card missing-analysis-detailed-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>assessment</mat-icon>
                Detailed Missing Value Analysis
              </mat-card-title>
              <mat-card-subtitle>Comprehensive missing value patterns and AI-powered handling strategies</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Enhanced Overall Summary -->
              <div class="missing-analysis-section overall-summary-enhanced" *ngIf="basicResults.missing_value_analysis.overall_summary">
                <h3>
                  <mat-icon>dashboard</mat-icon>
                  Missing Data Dashboard
                </h3>
                
                <div class="summary-dashboard">
                  <div class="summary-cards-grid">
                    <div class="summary-card total-values">
                      <div class="card-header">
                        <mat-icon>storage</mat-icon>
                        <span>Total Missing Values</span>
                      </div>
                      <div class="card-content">
                        <div class="large-number" [ngClass]="{'warning': basicResults.missing_value_analysis.overall_summary.total_missing_values > 0}">
                          {{ basicResults.missing_value_analysis.overall_summary.total_missing_values | number }}
                        </div>
                        <div class="percentage-bar">
                          <div class="bar-fill missing-bar" [style.width.%]="basicResults.missing_value_analysis.overall_summary.overall_missing_percentage"></div>
                        </div>
                        <div class="percentage-text">
                          {{ basicResults.missing_value_analysis.overall_summary.overall_missing_percentage | number:'1.2-2' }}% of all values
                        </div>
                      </div>
                    </div>

                    <div class="summary-card affected-columns">
                      <div class="card-header">
                        <mat-icon>view_column</mat-icon>
                        <span>Affected Columns</span>
                      </div>
                      <div class="card-content">
                        <div class="large-number" [ngClass]="{'warning': basicResults.missing_value_analysis.overall_summary.columns_with_missing > 0}">
                          {{ basicResults.missing_value_analysis.overall_summary.columns_with_missing | number }}
                        </div>
                        <div class="impact-indicator">
                          <mat-chip [color]="getColumnImpactColor(basicResults.missing_value_analysis.overall_summary.columns_with_missing)" selected>
                            {{ getColumnImpactLevel(basicResults.missing_value_analysis.overall_summary.columns_with_missing) }}
                          </mat-chip>
                        </div>
                      </div>
                    </div>

                    <div class="summary-card complete-data">
                      <div class="card-header">
                        <mat-icon>check_circle_outline</mat-icon>
                        <span>Complete Records</span>
                      </div>
                      <div class="card-content">
                        <div class="large-number success">
                          {{ basicResults.missing_value_analysis.overall_summary.complete_rows | number }}
                        </div>
                        <div class="percentage-bar">
                          <div class="bar-fill complete-bar" [style.width.%]="basicResults.missing_value_analysis.overall_summary.complete_rows_percentage"></div>
                        </div>
                        <div class="percentage-text">
                          {{ basicResults.missing_value_analysis.overall_summary.complete_rows_percentage | number:'1.1-1' }}% complete rows
                        </div>
                      </div>
                    </div>

                    <div class="summary-card data-quality">
                      <div class="card-header">
                        <mat-icon>verified</mat-icon>
                        <span>Data Quality Score</span>
                      </div>
                      <div class="card-content">
                        <div class="quality-score-display">
                          <div class="score-gauge" [ngClass]="getQualityScoreClass(basicResults.missing_value_analysis.overall_summary.complete_rows_percentage)">
                            <span class="score">{{ basicResults.missing_value_analysis.overall_summary.complete_rows_percentage | number:'1.0-0' }}</span>
                          </div>
                        </div>
                        <div class="quality-label">
                          {{ getQualityLabel(basicResults.missing_value_analysis.overall_summary.complete_rows_percentage) }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Enhanced Column-wise Analysis -->
              <div class="missing-analysis-section column-analysis-enhanced" *ngIf="basicResults.missing_value_analysis.column_analysis">
                <h3>
                  <mat-icon>analytics</mat-icon>
                  Column-wise Missing Value Analysis
                </h3>
                
                <div class="columns-analysis-container">
                  <div class="analysis-filters">
                    <mat-chip-listbox aria-label="Filter columns">
                      <mat-chip-option selected>All Columns</mat-chip-option>
                      <mat-chip-option>Missing Data Only</mat-chip-option>
                      <mat-chip-option>High Missing (&gt;20%)</mat-chip-option>
                      <mat-chip-option>Critical (&gt;50%)</mat-chip-option>
                    </mat-chip-listbox>
                  </div>

                  <div class="columns-grid">
                    <div *ngFor="let column of getMissingValueTableData()" class="column-analysis-card">
                      <div class="column-header">
                        <div class="column-name">
                          <mat-icon>{{ getColumnTypeIcon(column.type) }}</mat-icon>
                          <strong>{{ column.name }}</strong>
                        </div>
                        <div class="missing-severity">
                          <mat-chip [color]="getMissingSeverityColor(column.missing_percentage)" selected>
                            {{ getMissingSeverityLabel(column.missing_percentage) }}
                          </mat-chip>
                        </div>
                      </div>

                      <div class="column-metrics">
                        <div class="metric-row">
                          <span class="metric-label">Missing Count:</span>
                          <span class="metric-value">{{ column.missing_count | number }}</span>
                        </div>
                        <div class="metric-row">
                          <span class="metric-label">Missing Rate:</span>
                          <div class="rate-display">
                            <div class="rate-bar">
                              <div class="rate-fill" [style.width.%]="column.missing_percentage" [ngClass]="getMissingRateClass(column.missing_percentage)"></div>
                            </div>
                            <span class="rate-text">{{ column.missing_percentage | number:'1.1-1' }}%</span>
                          </div>
                        </div>
                        <div class="metric-row">
                          <span class="metric-label">Pattern:</span>
                          <mat-chip [color]="getPatternColor(column.pattern)" selected size="small">
                            {{ column.pattern }}
                          </mat-chip>
                        </div>
                      </div>

                      <div class="strategy-section">
                        <div class="strategy-header">
                          <mat-icon>psychology</mat-icon>
                          <span>AI Recommendation</span>
                        </div>
                        <div class="primary-strategy">
                          <strong>{{ column.suggested_strategy.primary }}</strong>
                        </div>
                        <div class="alternative-strategies" *ngIf="column.suggested_strategy.alternatives?.length > 0">
                          <span class="alternatives-label">Alternatives:</span>
                          <div class="alternatives-chips">
                            <mat-chip *ngFor="let alt of column.suggested_strategy.alternatives" color="accent" size="small">
                              {{ alt }}
                            </mat-chip>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Enhanced Recommendations -->
              <div class="missing-analysis-section recommendations-enhanced" *ngIf="basicResults.missing_value_analysis.recommendations?.length > 0">
                <h3>
                  <mat-icon>auto_awesome</mat-icon>
                  AI-Powered Recommendations
                </h3>
                
                <div class="recommendations-enhanced-list">
                  <div *ngFor="let recommendation of basicResults.missing_value_analysis.recommendations; let i = index" class="recommendation-enhanced-item">
                    <div class="recommendation-number">{{ i + 1 }}</div>
                    <div class="recommendation-content">
                      <mat-icon [ngClass]="getRecommendationTypeClass(recommendation)">{{ getRecommendationIcon(recommendation) }}</mat-icon>
                      <div class="recommendation-text">
                        <span [innerHTML]="recommendation"></span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Duplicates Check -->
          <mat-card *ngIf="basicResults.duplicates_analysis" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>content_copy</mat-icon>
                Duplicates Check
              </mat-card-title>
              <mat-card-subtitle>Full and partial duplicate detection with data quality insights</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Duplicates Summary -->
              <div class="duplicates-summary-section" *ngIf="basicResults.duplicates_analysis.summary">
                <h3>
                  <mat-icon>pie_chart</mat-icon>
                  Duplicate Summary
                </h3>
                
                <div class="duplicates-metrics">
                  <div class="metric-card duplicates-card">
                    <h4>Data Quality Score</h4>
                    <div class="quality-score" [ngClass]="getQualityScoreClass(basicResults.duplicates_analysis.summary.data_quality_score)">
                      {{ basicResults.duplicates_analysis.summary.data_quality_score | number:'1.1-1' }}%
                    </div>
                  </div>
                  
                  <div class="metric-card duplicates-card">
                    <h4>Total Rows</h4>
                    <div class="metric-value">{{ basicResults.duplicates_analysis.summary.total_rows | number }}</div>
                  </div>
                  
                  <div class="metric-card duplicates-card">
                    <h4>Unique Rows</h4>
                    <div class="metric-value highlight">{{ basicResults.duplicates_analysis.summary.unique_rows | number }}</div>
                  </div>
                  
                  <div class="metric-card duplicates-card">
                    <h4>Duplicate Rows</h4>
                    <div class="metric-value" [ngClass]="{'warning': basicResults.duplicates_analysis.summary.duplicate_rows > 0}">
                      {{ basicResults.duplicates_analysis.summary.duplicate_rows | number }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Full Duplicates Analysis -->
              <div class="duplicates-analysis-section" *ngIf="basicResults.duplicates_analysis.full_duplicates">
                <h3>
                  <mat-icon>layers</mat-icon>
                  Full Row Duplicates
                </h3>
                
                <div class="duplicates-info">
                  <div class="info-grid">
                    <div class="info-item">
                      <span class="info-label">Duplicate Count:</span>
                      <span class="info-value" [ngClass]="{'warning': basicResults.duplicates_analysis.full_duplicates.count > 0}">
                        {{ basicResults.duplicates_analysis.full_duplicates.count | number }}
                      </span>
                    </div>
                    <div class="info-item">
                      <span class="info-label">Duplicate Percentage:</span>
                      <span class="info-value" [ngClass]="{'warning': basicResults.duplicates_analysis.full_duplicates.percentage > 5}">
                        {{ basicResults.duplicates_analysis.full_duplicates.percentage | number:'1.2-2' }}%
                      </span>
                    </div>
                  </div>
                  
                  <!-- Duplicate Groups (if any) -->
                  <div *ngIf="basicResults.duplicates_analysis.full_duplicates.duplicate_groups?.length > 0" class="duplicate-groups">
                    <h4>Sample Duplicate Groups</h4>
                    <div *ngFor="let group of basicResults.duplicates_analysis.full_duplicates.duplicate_groups" class="duplicate-group">
                      <div class="group-header">
                        <strong>Group {{ group.group_id }}</strong> - {{ group.count }} identical rows
                      </div>
                      <div class="group-indices">
                        <small>Row indices: {{ group.indices.join(', ') }}</small>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Partial Duplicates Analysis -->
              <div class="duplicates-analysis-section" *ngIf="hasPartialDuplicates()">
                <h3>
                  <mat-icon>compare</mat-icon>
                  Partial Duplicates (Column Combinations)
                </h3>
                
                <div class="partial-duplicates-grid">
                  <div *ngFor="let duplicate of getPartialDuplicatesArray()" class="partial-duplicate-card">
                    <h4>{{ duplicate.key }}</h4>
                    <div class="partial-stats">
                      <div class="stat-item">
                        <span class="stat-label">Count:</span>
                        <span class="stat-value">{{ duplicate.value.count | number }}</span>
                      </div>
                      <div class="stat-item">
                        <span class="stat-label">Percentage:</span>
                        <span class="stat-value">{{ duplicate.value.percentage | number:'1.1-1' }}%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Impact Analysis -->
              <div class="duplicates-analysis-section" *ngIf="basicResults.duplicates_analysis.impact_analysis">
                <h3>
                  <mat-icon>insights</mat-icon>
                  Impact Analysis
                </h3>
                
                <div class="impact-grid">
                  <div class="impact-item">
                    <mat-icon>storage</mat-icon>
                    <div>
                      <strong>Memory Savings if Removed:</strong>
                      <span>{{ basicResults.duplicates_analysis.impact_analysis.memory_saved_if_removed }}</span>
                    </div>
                  </div>
                  <div class="impact-item">
                    <mat-icon>cleaning_services</mat-icon>
                    <div>
                      <strong>Rows After Deduplication:</strong>
                      <span>{{ basicResults.duplicates_analysis.impact_analysis.rows_after_deduplication | number }}</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recommendations -->
              <div class="duplicates-analysis-section" *ngIf="basicResults.duplicates_analysis.recommendations?.length > 0">
                <h3>
                  <mat-icon>recommend</mat-icon>
                  Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults.duplicates_analysis.recommendations" class="recommendation-item">
                    <mat-icon [ngClass]="getRecommendationIconClass(recommendation)">{{ getRecommendationIcon(recommendation) }}</mat-icon>
                    <span [innerHTML]="recommendation"></span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Type/Integrity Validation -->
          <mat-card *ngIf="basicResults.type_integrity_validation" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>verified</mat-icon>
                Type/Integrity Validation
              </mat-card-title>
              <mat-card-subtitle>Data type consistency and integrity validation with quality scoring</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Overall Quality Summary -->
              <div class="validation-summary-section" *ngIf="basicResults.type_integrity_validation.summary">
                <h3>
                  <mat-icon>assessment</mat-icon>
                  Overall Data Quality Assessment
                </h3>
                
                <div class="quality-metrics">
                  <div class="metric-card quality-card">
                    <h4>Overall Quality Score</h4>
                    <div class="quality-score" [ngClass]="getIntegrityScoreClass(basicResults.type_integrity_validation.overall_quality_score)">
                      {{ basicResults.type_integrity_validation.overall_quality_score | number:'1.1-1' }}%
                    </div>
                  </div>
                  
                  <div class="metric-card quality-card">
                    <h4>Columns Analyzed</h4>
                    <div class="metric-value">{{ basicResults.type_integrity_validation.summary.columns_analyzed | number }}</div>
                  </div>
                  
                  <div class="metric-card quality-card">
                    <h4>Columns with Issues</h4>
                    <div class="metric-value" [ngClass]="{'warning': basicResults.type_integrity_validation.summary.columns_with_issues > 0}">
                      {{ basicResults.type_integrity_validation.summary.columns_with_issues | number }}
                    </div>
                  </div>
                  
                  <div class="metric-card quality-card">
                    <h4>Critical Issues</h4>
                    <div class="metric-value" [ngClass]="{'error': basicResults.type_integrity_validation.summary.critical_issues > 0}">
                      {{ basicResults.type_integrity_validation.summary.critical_issues | number }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Column-wise Validation Results -->
              <div class="validation-analysis-section">
                <h3>
                  <mat-icon>table_chart</mat-icon>
                  Column-wise Validation Results
                </h3>
                
                <div class="validation-table-container">
                  <table mat-table [dataSource]="getTypeValidationTableData()" class="validation-table">
                    <ng-container matColumnDef="column">
                      <th mat-header-cell *matHeaderCellDef>Column</th>
                      <td mat-cell *matCellDef="let element">
                        <strong>{{ element.name }}</strong>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="types">
                      <th mat-header-cell *matHeaderCellDef>Type Analysis</th>
                      <td mat-cell *matCellDef="let element">
                        <div class="type-comparison">
                          <div class="type-item">
                            <span class="type-label">Declared:</span>
                            <mat-chip color="primary" selected>{{ element.declared_type }}</mat-chip>
                          </div>
                          <div class="type-item" *ngIf="element.declared_type !== element.inferred_type">
                            <span class="type-label">Inferred:</span>
                            <mat-chip color="accent" selected>{{ element.inferred_type }}</mat-chip>
                          </div>
                        </div>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="score">
                      <th mat-header-cell *matHeaderCellDef>Integrity Score</th>
                      <td mat-cell *matCellDef="let element">
                        <div class="integrity-score-cell" [ngClass]="getIntegrityScoreClass(element.integrity_score)">
                          {{ element.integrity_score | number:'1.0-0' }}%
                        </div>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="issues">
                      <th mat-header-cell *matHeaderCellDef>Issues</th>
                      <td mat-cell *matCellDef="let element">
                        <div class="issues-summary">
                          <mat-chip [color]="element.issues_count > 0 ? 'warn' : 'primary'" selected>
                            {{ element.issues_count }} issues
                          </mat-chip>
                          <div *ngIf="element.issues_count > 0" class="issues-list">
                            <div *ngFor="let issue of element.issues" class="issue-item">
                              <mat-icon>{{ issue.includes('Critical') ? 'error' : 'warning' }}</mat-icon>
                              <span>{{ issue }}</span>
                            </div>
                          </div>
                        </div>
                      </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="['column', 'types', 'score', 'issues']"></tr>
                    <tr mat-row *matRowDef="let row; columns: ['column', 'types', 'score', 'issues'];"></tr>
                  </table>
                </div>
              </div>

              <!-- Global Issues -->
              <div class="global-issues-section" *ngIf="basicResults.type_integrity_validation.global_issues?.length > 0">
                <h3>
                  <mat-icon>public</mat-icon>
                  Global Data Structure Issues
                </h3>
                
                <div class="global-issues-list">
                  <div *ngFor="let issue of basicResults.type_integrity_validation.global_issues" class="global-issue-item">
                    <mat-icon [ngClass]="issue.includes('Critical') ? 'error' : 'warning'">
                      {{ issue.includes('Critical') ? 'error' : 'warning' }}
                    </mat-icon>
                    <span>{{ issue }}</span>
                  </div>
                </div>
              </div>

              <!-- Recommendations -->
              <div class="validation-recommendations-section" *ngIf="basicResults.type_integrity_validation.recommendations?.length > 0">
                <h3>
                  <mat-icon>lightbulb</mat-icon>
                  Data Quality Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults.type_integrity_validation.recommendations" class="recommendation-item">
                    <mat-icon [ngClass]="getRecommendationIconClass(recommendation)">{{ getRecommendationIcon(recommendation) }}</mat-icon>
                    <span [innerHTML]="recommendation"></span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Univariate Summaries -->
          <mat-card *ngIf="basicResults.univariate_summaries" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>analytics</mat-icon>
                Univariate Summaries
              </mat-card-title>
              <mat-card-subtitle>Comprehensive analysis for numeric, categorical, and temporal columns</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Overview -->
              <div class="univariate-overview-section" *ngIf="basicResults.univariate_summaries.overview">
                <h3>
                  <mat-icon>dashboard</mat-icon>
                  Column Type Overview
                </h3>
                
                <div class="overview-grid">
                  <div class="overview-item">
                    <mat-icon>123</mat-icon>
                    <div class="overview-content">
                      <h4>{{ basicResults.univariate_summaries.overview.numeric_columns }}</h4>
                      <span>Numeric Columns</span>
                    </div>
                  </div>
                  <div class="overview-item">
                    <mat-icon>category</mat-icon>
                    <div class="overview-content">
                      <h4>{{ basicResults.univariate_summaries.overview.categorical_columns }}</h4>
                      <span>Categorical Columns</span>
                    </div>
                  </div>
                  <div class="overview-item">
                    <mat-icon>schedule</mat-icon>
                    <div class="overview-content">
                      <h4>{{ basicResults.univariate_summaries.overview.temporal_columns }}</h4>
                      <span>Temporal Columns</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Numeric Summaries -->
              <div class="numeric-summaries-section" *ngIf="getNumericSummaryColumns().length > 0">
                <h3>
                  <mat-icon>functions</mat-icon>
                  Numeric Variables Analysis
                </h3>
                
                <div class="numeric-summary-grid">
                  <div *ngFor="let column of getNumericSummaryColumns()" class="numeric-summary-card">
                    <h4>{{ column }}</h4>
                    
                    <div class="summary-tabs">
                      <mat-tab-group>
                        <mat-tab label="Basic Stats">
                          <div class="basic-stats-grid">
                            <div class="stat-item">
                              <span class="stat-label">Mean:</span>
                              <span class="stat-value">{{ getNumericSummaryData(column).basic_stats?.mean | number:'1.3-3' }}</span>
                            </div>
                            <div class="stat-item">
                              <span class="stat-label">Median:</span>
                              <span class="stat-value">{{ getNumericSummaryData(column).basic_stats?.median | number:'1.3-3' }}</span>
                            </div>
                            <div class="stat-item">
                              <span class="stat-label">Std Dev:</span>
                              <span class="stat-value">{{ getNumericSummaryData(column).basic_stats?.std | number:'1.3-3' }}</span>
                            </div>
                            <div class="stat-item">
                              <span class="stat-label">Range:</span>
                              <span class="stat-value">{{ getNumericSummaryData(column).basic_stats?.range | number:'1.3-3' }}</span>
                            </div>
                            <div class="stat-item">
                              <span class="stat-label">IQR:</span>
                              <span class="stat-value">{{ getNumericSummaryData(column).basic_stats?.iqr | number:'1.3-3' }}</span>
                            </div>
                          </div>
                        </mat-tab>
                        
                        <mat-tab label="Distribution">
                          <div class="distribution-info">
                            <div class="dist-item">
                              <strong>Shape:</strong>
                              <span>{{ formatDistributionShape(getNumericSummaryData(column).distribution_stats?.distribution_shape) }}</span>
                            </div>
                            <div class="dist-item">
                              <strong>Skewness:</strong>
                              <span>{{ getNumericSummaryData(column).distribution_stats?.skewness | number:'1.3-3' }}</span>
                            </div>
                            <div class="dist-item">
                              <strong>Kurtosis:</strong>
                              <span>{{ getNumericSummaryData(column).distribution_stats?.kurtosis | number:'1.3-3' }}</span>
                            </div>
                            <div class="dist-item">
                              <strong>Normality:</strong>
                              <span>{{ formatNormalityTest(getNumericSummaryData(column).distribution_stats?.is_normal) }}</span>
                            </div>
                          </div>
                        </mat-tab>
                        
                        <mat-tab label="Insights">
                          <div class="insights-list">
                            <div *ngFor="let insight of getNumericSummaryData(column).business_insights" class="insight-item">
                              <mat-icon>lightbulb</mat-icon>
                              <span>{{ insight }}</span>
                            </div>
                          </div>
                        </mat-tab>
                      </mat-tab-group>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Categorical Summaries -->
              <div class="categorical-summaries-section" *ngIf="getCategoricalSummaryColumns().length > 0">
                <h3>
                  <mat-icon>label</mat-icon>
                  Categorical Variables Analysis
                </h3>
                
                <div class="categorical-summary-grid">
                  <div *ngFor="let column of getCategoricalSummaryColumns()" class="categorical-summary-card">
                    <h4>{{ column }}</h4>
                    
                    <div class="categorical-stats">
                      <div class="cat-stat-item">
                        <span class="stat-label">Unique Values:</span>
                        <span class="stat-value">{{ getCategoricalSummaryData(column).basic_stats?.unique_count | number }}</span>
                      </div>
                      <div class="cat-stat-item">
                        <span class="stat-label">Most Frequent:</span>
                        <span class="stat-value">{{ getCategoricalSummaryData(column).basic_stats?.mode }}</span>
                      </div>
                      <div class="cat-stat-item">
                        <span class="stat-label">Frequency:</span>
                        <span class="stat-value">{{ getCategoricalSummaryData(column).basic_stats?.mode_percentage | number:'1.1-1' }}%</span>
                      </div>
                      <div class="cat-stat-item">
                        <span class="stat-label">Entropy:</span>
                        <span class="stat-value">{{ getCategoricalSummaryData(column).distribution_stats?.entropy | number:'1.2-2' }}</span>
                      </div>
                    </div>
                    
                    <!-- Top Categories -->
                    <div class="top-categories" *ngIf="getCategoricalSummaryData(column).top_categories">
                      <h5>Top Categories</h5>
                      <div class="categories-list">
                        <div *ngFor="let item of getTopCategoriesArray(getCategoricalSummaryData(column).top_categories).slice(0, 5)" 
                             class="category-item">
                          <span class="category-name">{{ item.category }}</span>
                          <span class="category-count">{{ item.count | number }}</span>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Quality Checks -->
                    <div class="quality-checks" *ngIf="getCategoricalSummaryData(column).quality_checks">
                      <h5>Quality Issues</h5>
                      <div class="quality-item" *ngIf="getCategoricalSummaryData(column).quality_checks.has_empty_strings > 0">
                        <mat-icon>warning</mat-icon>
                        <span>{{ getCategoricalSummaryData(column).quality_checks.has_empty_strings }} empty strings</span>
                      </div>
                      <div class="quality-item" *ngIf="getCategoricalSummaryData(column).quality_checks.case_inconsistency > 0">
                        <mat-icon>warning</mat-icon>
                        <span>{{ getCategoricalSummaryData(column).quality_checks.case_inconsistency }} case inconsistencies</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Temporal Summaries -->
              <div class="temporal-summaries-section" *ngIf="getTemporalSummaryColumns().length > 0">
                <h3>
                  <mat-icon>date_range</mat-icon>
                  Temporal Variables Analysis
                </h3>
                
                <div class="temporal-summary-grid">
                  <div *ngFor="let column of getTemporalSummaryColumns()" class="temporal-summary-card">
                    <h4>{{ column }}</h4>
                    
                    <div class="temporal-stats">
                      <div class="temp-stat-item">
                        <span class="stat-label">Date Range:</span>
                        <span class="stat-value">{{ getTemporalSummaryData(column).basic_stats?.date_range_days | number }} days</span>
                      </div>
                      <div class="temp-stat-item">
                        <span class="stat-label">From:</span>
                        <span class="stat-value">{{ getTemporalSummaryData(column).basic_stats?.min_date | date:'short' }}</span>
                      </div>
                      <div class="temp-stat-item">
                        <span class="stat-label">To:</span>
                        <span class="stat-value">{{ getTemporalSummaryData(column).basic_stats?.max_date | date:'short' }}</span>
                      </div>
                      <div class="temp-stat-item">
                        <span class="stat-label">Year Range:</span>
                        <span class="stat-value">{{ getTemporalSummaryData(column).temporal_patterns?.year_range }}</span>
                      </div>
                    </div>
                    
                    <!-- Insights -->
                    <div class="temporal-insights">
                      <div *ngFor="let insight of getTemporalSummaryData(column).business_insights" class="insight-item">
                        <mat-icon>insights</mat-icon>
                        <span>{{ insight }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Outlier Detection -->
          <mat-card *ngIf="basicResults.outlier_detection" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>scatter_plot</mat-icon>
                Outlier Detection
              </mat-card-title>
              <mat-card-subtitle>Multi-method outlier detection using statistical and machine learning approaches</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Summary -->
              <div class="outlier-summary-section" *ngIf="basicResults.outlier_detection.summary">
                <h3>
                  <mat-icon>summarize</mat-icon>
                  Outlier Detection Summary
                </h3>
                
                <div class="outlier-metrics">
                  <div class="metric-card outlier-card">
                    <h4>Total Outliers</h4>
                    <div class="metric-value" [ngClass]="{'warning': basicResults.outlier_detection.summary.total_outlier_count > 0}">
                      {{ basicResults.outlier_detection.summary.total_outlier_count | number }}
                    </div>
                  </div>
                  
                  <div class="metric-card outlier-card">
                    <h4>Outlier Percentage</h4>
                    <div class="metric-value" [ngClass]="{'warning': basicResults.outlier_detection.summary.outlier_percentage > 5}">
                      {{ basicResults.outlier_detection.summary.outlier_percentage | number:'1.2-2' }}%
                    </div>
                  </div>
                  
                  <div class="metric-card outlier-card">
                    <h4>Columns Affected</h4>
                    <div class="metric-value">
                      {{ basicResults.outlier_detection.summary.columns_with_outliers | number }}
                    </div>
                  </div>
                  
                  <div class="metric-card outlier-card">
                    <h4>Numeric Columns</h4>
                    <div class="metric-value">
                      {{ basicResults.outlier_detection.summary.total_numeric_columns | number }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Univariate Outliers -->
              <div class="univariate-outliers-section" *ngIf="getOutlierDetectionColumns().length > 0">
                <h3>
                  <mat-icon>timeline</mat-icon>
                  Column-wise Outlier Analysis
                </h3>
                
                <div class="outlier-analysis-grid">
                  <div *ngFor="let column of getOutlierDetectionColumns()" class="outlier-analysis-card">
                    <h4>{{ column }}</h4>
                    
                    <div class="outlier-severity">
                      <mat-chip [color]="getOutlierSeverityClass(getOutlierData(column).severity)" selected>
                        {{ getOutlierData(column).severity | titlecase }} Severity
                      </mat-chip>
                      <span class="outlier-count">{{ getOutlierData(column).total_outliers | number }} outliers</span>
                    </div>
                    
                    <div class="outlier-methods-summary">
                      <h5>Detection Methods</h5>
                      <div class="methods-grid">
                        <div class="method-item">
                          <span class="method-name">IQR Method:</span>
                          <span class="method-result">{{ getOutlierMethodData(column, 'iqr').outlier_count | number }} ({{ getOutlierMethodData(column, 'iqr').outlier_percentage | number:'1.1-1' }}%)</span>
                        </div>
                        <div class="method-item">
                          <span class="method-name">Z-Score:</span>
                          <span class="method-result">{{ getOutlierMethodData(column, 'zscore').outlier_count | number }} ({{ getOutlierMethodData(column, 'zscore').outlier_percentage | number:'1.1-1' }}%)</span>
                        </div>
                        <div class="method-item">
                          <span class="method-name">Modified Z-Score:</span>
                          <span class="method-result">{{ getOutlierMethodData(column, 'modified_zscore').outlier_count | number }} ({{ getOutlierMethodData(column, 'modified_zscore').outlier_percentage | number:'1.1-1' }}%)</span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="recommended-method">
                      <strong>Recommended Method:</strong>
                      <mat-chip color="primary" selected>{{ formatOutlierMethod(getOutlierData(column).best_method) }}</mat-chip>
                    </div>
                    
                    <!-- Sample Outlier Values -->
                    <div class="sample-outliers" *ngIf="getOutlierData(column).sample_outlier_values?.length > 0">
                      <h5>Sample Outlier Values</h5>
                      <div class="outlier-values">
                        <mat-chip *ngFor="let value of getOutlierData(column).sample_outlier_values" 
                                  color="warn" 
                                  selected>
                          {{ value | number:'1.2-2' }}
                        </mat-chip>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Multivariate Outliers -->
              <div class="multivariate-outliers-section" *ngIf="hasMultivariateOutliers()">
                <h3>
                  <mat-icon>bubble_chart</mat-icon>
                  Multivariate Outlier Analysis
                </h3>
                
                <div class="multivariate-results">
                  <!-- Isolation Forest Results -->
                  <div class="multivariate-method" *ngIf="getMultivariateOutlierData().isolation_forest && !getMultivariateOutlierData().isolation_forest.error">
                    <h4>
                      <mat-icon>forest</mat-icon>
                      Isolation Forest Detection
                    </h4>
                    
                    <div class="method-results">
                      <div class="result-item">
                        <span class="result-label">Outliers Detected:</span>
                        <span class="result-value">{{ getMultivariateOutlierData().isolation_forest.outlier_count | number }}</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Outlier Percentage:</span>
                        <span class="result-value">{{ getMultivariateOutlierData().isolation_forest.outlier_percentage | number:'1.2-2' }}%</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Score Range:</span>
                        <span class="result-value">
                          {{ getMultivariateOutlierData().isolation_forest.outlier_scores_summary?.min_score | number:'1.3-3' }} to 
                          {{ getMultivariateOutlierData().isolation_forest.outlier_scores_summary?.max_score | number:'1.3-3' }}
                        </span>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Mahalanobis Distance Results -->
                  <div class="multivariate-method" *ngIf="getMultivariateOutlierData().mahalanobis && !getMultivariateOutlierData().mahalanobis.error">
                    <h4>
                      <mat-icon>radar</mat-icon>
                      Mahalanobis Distance Detection
                    </h4>
                    
                    <div class="method-results">
                      <div class="result-item">
                        <span class="result-label">Outliers Detected:</span>
                        <span class="result-value">{{ getMultivariateOutlierData().mahalanobis.outlier_count | number }}</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Outlier Percentage:</span>
                        <span class="result-value">{{ getMultivariateOutlierData().mahalanobis.outlier_percentage | number:'1.2-2' }}%</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Threshold:</span>
                        <span class="result-value">{{ getMultivariateOutlierData().mahalanobis.threshold | number:'1.2-2' }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recommendations -->
              <div class="outlier-recommendations-section" *ngIf="basicResults.outlier_detection.recommendations?.length > 0">
                <h3>
                  <mat-icon>psychology</mat-icon>
                  Outlier Handling Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults.outlier_detection.recommendations" class="recommendation-item">
                    <mat-icon [ngClass]="getRecommendationIconClass(recommendation)">{{ getRecommendationIcon(recommendation) }}</mat-icon>
                    <span [innerHTML]="recommendation"></span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    </mat-tab>

    <!-- Advanced Statistics Tab -->
    <mat-tab label="Advanced Statistics">
      <div class="tab-content">
        <!-- Options Selection -->
        <mat-card class="options-card">
          <mat-card-header>
            <mat-card-title>Advanced Analysis Options</mat-card-title>
            <mat-card-subtitle>Select advanced statistical and ML analyses</mat-card-subtitle>
          </mat-card-header>
          
          <mat-card-content>
            <div class="options-grid">
              <mat-checkbox 
                *ngFor="let option of advancedOptions" 
                [(ngModel)]="option.selected"
                class="option-checkbox">
                <div class="option-content">
                  <span class="option-name">{{ option.name }}</span>
                  <span class="option-description">{{ option.description }}</span>
                </div>
              </mat-checkbox>
            </div>
          </mat-card-content>
          
          <mat-card-actions>
            <button mat-raised-button 
                    color="accent" 
                    (click)="calculateAdvancedStatistics()"
                    [disabled]="isLoading">
              <mat-icon>science</mat-icon>
              Calculate Advanced Statistics
            </button>
            
            <mat-spinner *ngIf="isLoading" diameter="24" class="inline-spinner"></mat-spinner>
          </mat-card-actions>
        </mat-card>

        <!-- Advanced Results -->
        <div class="results-section" *ngIf="advancedResults">
          <!-- Regression Analysis -->
          <mat-card *ngIf="advancedResults.regression_analysis" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>trending_up</mat-icon>
                Regression Analysis
              </mat-card-title>
            </mat-card-header>
            
            <mat-card-content>
              <div class="regression-content">
                <div class="metrics-grid" *ngIf="advancedResults.regression_analysis.metrics">
                  <div class="metric-item">
                    <span class="metric-label">R² Score</span>
                    <span class="metric-value">{{ formatNumber(advancedResults.regression_analysis.metrics.r2_score) }}</span>
                  </div>
                  <div class="metric-item">
                    <span class="metric-label">Mean Squared Error</span>
                    <span class="metric-value">{{ formatNumber(advancedResults.regression_analysis.metrics.mse) }}</span>
                  </div>
                  <div class="metric-item">
                    <span class="metric-label">Mean Absolute Error</span>
                    <span class="metric-value">{{ formatNumber(advancedResults.regression_analysis.metrics.mae) }}</span>
                  </div>
                </div>
                <div class="feature-importance" *ngIf="advancedResults.regression_analysis.feature_importance">
                  <h4>Feature Importance</h4>
                  <div class="importance-list">
                    <div class="importance-item" *ngFor="let item of getFeatureImportanceEntries()">
                      <span class="feature-name">{{ item.key }}</span>
                      <div class="importance-bar">
                        <div class="importance-fill" [style.width.%]="(item.value * 100)"></div>
                      </div>
                      <span class="importance-value">{{ formatNumber(item.value) }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Clustering Results -->
          <mat-card *ngIf="advancedResults.clustering_results" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>scatter_plot</mat-icon>
                Clustering Analysis
              </mat-card-title>
            </mat-card-header>
            
            <mat-card-content>
              <div class="clustering-content">
                <div class="cluster-summary" *ngIf="advancedResults.clustering_results.summary">
                  <p><strong>Number of Clusters:</strong> {{ advancedResults.clustering_results.summary.n_clusters }}</p>
                  <p><strong>Silhouette Score:</strong> {{ formatNumber(advancedResults.clustering_results.summary.silhouette_score) }}</p>
                  <p><strong>Inertia:</strong> {{ formatNumber(advancedResults.clustering_results.summary.inertia) }}</p>
                </div>
                <div class="cluster-details" *ngIf="advancedResults.clustering_results.cluster_centers">
                  <h4>Cluster Centers</h4>
                  <pre>{{ advancedResults.clustering_results.cluster_centers | json }}</pre>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- PCA Analysis -->
          <mat-card *ngIf="advancedResults.pca_analysis" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>compress</mat-icon>
                Principal Component Analysis
              </mat-card-title>
            </mat-card-header>
            
            <mat-card-content>
              <div class="pca-content">
                <div class="pca-summary" *ngIf="advancedResults.pca_analysis.explained_variance_ratio">
                  <h4>Explained Variance by Component</h4>
                  <div class="variance-list">
                    <div class="variance-item" *ngFor="let variance of advancedResults.pca_analysis.explained_variance_ratio; let i = index">
                      <span class="component-label">PC{{ i + 1 }}</span>
                      <div class="variance-bar">
                        <div class="variance-fill" [style.width.%]="(variance * 100)"></div>
                      </div>
                      <span class="variance-value">{{ (variance * 100).toFixed(2) }}%</span>
                    </div>
                  </div>
                </div>
                <div class="cumulative-variance" *ngIf="advancedResults.pca_analysis.cumulative_variance">
                  <p><strong>Total Variance Explained:</strong> {{ (advancedResults.pca_analysis.cumulative_variance * 100).toFixed(2) }}%</p>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Time Series Analysis -->
          <mat-card *ngIf="advancedResults.time_series_analysis" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>timeline</mat-icon>
                Time Series Analysis
              </mat-card-title>
            </mat-card-header>
            
            <mat-card-content>
              <div class="timeseries-content">
                <pre>{{ advancedResults.time_series_analysis | json }}</pre>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Anomaly Detection -->
          <mat-card *ngIf="advancedResults.anomaly_detection" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>warning</mat-icon>
                Anomaly Detection
              </mat-card-title>
            </mat-card-header>
            
            <mat-card-content>
              <div class="anomaly-content">
                <div class="anomaly-summary" *ngIf="advancedResults.anomaly_detection.summary">
                  <p><strong>Anomalies Detected:</strong> {{ advancedResults.anomaly_detection.summary.n_anomalies }}</p>
                  <p><strong>Anomaly Rate:</strong> {{ (advancedResults.anomaly_detection.summary.anomaly_rate * 100).toFixed(2) }}%</p>
                </div>
                <div class="anomaly-details" *ngIf="advancedResults.anomaly_detection.anomaly_indices">
                  <h4>Anomalous Records (indices)</h4>
                  <mat-chip-set>
                    <mat-chip *ngFor="let index of advancedResults.anomaly_detection.anomaly_indices.slice(0, 10)">
                      {{ index }}
                    </mat-chip>
                    <mat-chip *ngIf="advancedResults.anomaly_detection.anomaly_indices.length > 10">
                      +{{ advancedResults.anomaly_detection.anomaly_indices.length - 10 }} more
                    </mat-chip>
                  </mat-chip-set>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Feature Engineering Ideas -->
          <mat-card *ngIf="basicResults?.feature_engineering_ideas" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>engineering</mat-icon>
                Feature Engineering Ideas
              </mat-card-title>
              <mat-card-subtitle>AI-powered suggestions for feature transformations and enhancements</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Transformation Ideas -->
              <div class="feature-section" *ngIf="basicResults?.feature_engineering_ideas?.transformation_ideas?.length > 0">
                <h3>
                  <mat-icon>transform</mat-icon>
                  Transformation Suggestions
                </h3>
                
                <div class="transformation-grid">
                  <div *ngFor="let idea of basicResults?.feature_engineering_ideas?.transformation_ideas" class="transformation-card">
                    <h4>{{ idea.column }}</h4>
                    <div class="issue-description">
                      <strong>Issue:</strong> {{ idea.issue }}
                    </div>
                    <div class="suggestions">
                      <strong>Suggestions:</strong>
                      <ul>
                        <li *ngFor="let suggestion of idea.suggestions">{{ suggestion }}</li>
                      </ul>
                    </div>
                    <mat-chip [color]="getPriorityColor(idea.priority)" selected>
                      {{ idea.priority | titlecase }} Priority
                    </mat-chip>
                  </div>
                </div>
              </div>

              <!-- Interaction Features -->
              <div class="feature-section" *ngIf="basicResults?.feature_engineering_ideas?.interaction_features?.length > 0">
                <h3>
                  <mat-icon>link</mat-icon>
                  Interaction Features
                </h3>
                
                <div class="interaction-grid">
                  <div *ngFor="let interaction of basicResults?.feature_engineering_ideas?.interaction_features" class="interaction-card">
                    <div class="feature-pair">
                      <strong>{{ interaction.feature_1 }}</strong> × <strong>{{ interaction.feature_2 }}</strong>
                    </div>
                    <div class="correlation-info">
                      Correlation: {{ formatNumber(interaction.correlation) }}
                    </div>
                    <div class="operations">
                      <strong>Suggested Operations:</strong>
                      <div class="operation-chips">
                        <mat-chip *ngFor="let op of interaction.suggested_operations" color="primary" selected>
                          {{ op }}
                        </mat-chip>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Encoding Suggestions -->
              <div class="feature-section" *ngIf="basicResults?.feature_engineering_ideas?.encoding_suggestions?.length > 0">
                <h3>
                  <mat-icon>code</mat-icon>
                  Encoding Recommendations
                </h3>
                
                <div class="encoding-grid">
                  <div *ngFor="let encoding of basicResults?.feature_engineering_ideas?.encoding_suggestions" class="encoding-card">
                    <h4>{{ encoding.column }}</h4>
                    <div class="encoding-details">
                      <div class="detail-item">
                        <span class="label">Unique Values:</span>
                        <span class="value">{{ encoding.unique_values }}</span>
                      </div>
                      <div class="detail-item">
                        <span class="label">Suggested Encoding:</span>
                        <span class="value">{{ encoding.suggested_encoding }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Documentation Summary -->
          <mat-card *ngIf="basicResults?.documentation_summary" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>description</mat-icon>
                Documentation Summary
              </mat-card-title>
              <mat-card-subtitle>Comprehensive data dictionary and analysis findings</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Dataset Summary -->
              <div class="documentation-section" *ngIf="basicResults?.documentation_summary?.dataset_summary">
                <h3>
                  <mat-icon>summarize</mat-icon>
                  Dataset Overview
                </h3>
                
                <div class="summary-grid">
                  <div class="summary-item">
                    <span class="summary-label">Total Rows:</span>
                    <span class="summary-value">{{ basicResults?.documentation_summary?.dataset_summary?.total_rows | number }}</span>
                  </div>
                  <div class="summary-item">
                    <span class="summary-label">Total Columns:</span>
                    <span class="summary-value">{{ basicResults?.documentation_summary?.dataset_summary?.total_columns | number }}</span>
                  </div>
                  <div class="summary-item">
                    <span class="summary-label">Memory Usage:</span>
                    <span class="summary-value">{{ basicResults?.documentation_summary?.dataset_summary?.memory_usage_mb | number:'1.2-2' }} MB</span>
                  </div>
                  <div class="summary-item">
                    <span class="summary-label">Missing Values:</span>
                    <span class="summary-value">{{ basicResults?.documentation_summary?.dataset_summary?.missing_percentage | number:'1.2-2' }}%</span>
                  </div>
                </div>
              </div>

              <!-- Key Findings -->
              <div class="documentation-section" *ngIf="basicResults?.documentation_summary?.key_findings?.length > 0">
                <h3>
                  <mat-icon>insights</mat-icon>
                  Key Findings
                </h3>
                
                <div class="findings-list">
                  <div *ngFor="let finding of basicResults?.documentation_summary?.key_findings" class="finding-item">
                    <mat-icon>arrow_forward</mat-icon>
                    <span>{{ finding }}</span>
                  </div>
                </div>
              </div>

              <!-- Analysis Recommendations -->
              <div class="documentation-section" *ngIf="basicResults?.documentation_summary?.analysis_recommendations?.length > 0">
                <h3>
                  <mat-icon>lightbulb</mat-icon>
                  Analysis Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults?.documentation_summary?.analysis_recommendations" class="recommendation-item">
                    <mat-icon>check_circle</mat-icon>
                    <span>{{ recommendation }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Multicollinearity Assessment -->
          <mat-card *ngIf="basicResults?.multicollinearity_assessment" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>device_hub</mat-icon>
                Multicollinearity Assessment
              </mat-card-title>
              <mat-card-subtitle>VIF analysis and correlation-based multicollinearity detection</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- High Correlations -->
              <div class="multicollinearity-section" *ngIf="basicResults?.multicollinearity_assessment?.correlation_analysis?.high_correlations?.length > 0">
                <h3>
                  <mat-icon>warning</mat-icon>
                  High Correlations Detected
                </h3>
                
                <div class="high-correlations-table">
                  <table mat-table [dataSource]="basicResults?.multicollinearity_assessment?.correlation_analysis?.high_correlations" class="correlation-table">
                    <ng-container matColumnDef="variables">
                      <th mat-header-cell *matHeaderCellDef>Variable Pair</th>
                      <td mat-cell *matCellDef="let element">
                        <strong>{{ element.variable_1 }}</strong> ↔ <strong>{{ element.variable_2 }}</strong>
                      </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="correlation">
                      <th mat-header-cell *matHeaderCellDef>Correlation</th>
                      <td mat-cell *matCellDef="let element">
                        {{ formatNumber(element.correlation) }}
                      </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="severity">
                      <th mat-header-cell *matHeaderCellDef>Severity</th>
                      <td mat-cell *matCellDef="let element">
                        <mat-chip [color]="element.severity === 'critical' ? 'warn' : 'accent'" selected>
                          {{ element.severity | titlecase }}
                        </mat-chip>
                      </td>
                    </ng-container>
                    
                    <tr mat-header-row *matHeaderRowDef="['variables', 'correlation', 'severity']"></tr>
                    <tr mat-row *matRowDef="let row; columns: ['variables', 'correlation', 'severity'];"></tr>
                  </table>
                </div>
              </div>

              <!-- VIF Analysis -->
              <div class="multicollinearity-section" *ngIf="basicResults?.multicollinearity_assessment?.vif_analysis?.length > 0">
                <h3>
                  <mat-icon>analytics</mat-icon>
                  Variance Inflation Factor (VIF) Analysis
                </h3>
                
                <div class="vif-grid">
                  <div *ngFor="let vif of basicResults?.multicollinearity_assessment?.vif_analysis" class="vif-card">
                    <h4>{{ vif.variable }}</h4>
                    <div class="vif-score" [ngClass]="getVIFClass(vif.vif)">
                      {{ formatNumber(vif.vif) }}
                    </div>
                    <div class="vif-interpretation">
                      {{ vif.interpretation }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recommendations -->
              <div class="multicollinearity-section" *ngIf="basicResults?.multicollinearity_assessment?.recommendations?.length > 0">
                <h3>
                  <mat-icon>lightbulb</mat-icon>
                  Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults?.multicollinearity_assessment?.recommendations" class="recommendation-item">
                    <mat-icon>arrow_forward</mat-icon>
                    <span>{{ recommendation }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Dimensionality Insights -->
          <mat-card *ngIf="basicResults?.dimensionality_insights" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>scatter_plot</mat-icon>
                Dimensionality Insights
              </mat-card-title>
              <mat-card-subtitle>PCA and clustering analysis for dimensionality reduction</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- PCA Analysis -->
              <div class="dimensionality-section" *ngIf="basicResults?.dimensionality_insights?.pca_analysis">
                <h3>
                  <mat-icon>compress</mat-icon>
                  Principal Component Analysis
                </h3>
                
                <div class="pca-summary">
                  <div class="pca-metrics">
                    <div class="metric-item">
                      <span class="metric-label">Original Dimensions:</span>
                      <span class="metric-value">{{ basicResults?.dimensionality_insights?.pca_analysis?.total_components }}</span>
                    </div>
                    <div class="metric-item">
                      <span class="metric-label">Components for 95% Variance:</span>
                      <span class="metric-value highlight">{{ basicResults?.dimensionality_insights?.pca_analysis?.components_for_95_variance }}</span>
                    </div>
                    <div class="metric-item">
                      <span class="metric-label">Components for 90% Variance:</span>
                      <span class="metric-value">{{ basicResults?.dimensionality_insights?.pca_analysis?.components_for_90_variance }}</span>
                    </div>
                    <div class="metric-item">
                      <span class="metric-label">Reduction Potential:</span>
                      <span class="metric-value" [ngClass]="{'success': basicResults?.dimensionality_insights?.pca_analysis?.dimensionality_reduction_potential === 'high'}">
                        {{ basicResults?.dimensionality_insights?.pca_analysis?.dimensionality_reduction_potential | titlecase }}
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Clustering Analysis -->
              <div class="dimensionality-section" *ngIf="basicResults?.dimensionality_insights?.clustering_analysis">
                <h3>
                  <mat-icon>group_work</mat-icon>
                  Clustering Structure Analysis
                </h3>
                
                <div class="clustering-summary">
                  <div class="clustering-metrics">
                    <div class="metric-item">
                      <span class="metric-label">Optimal Clusters:</span>
                      <span class="metric-value highlight">{{ basicResults?.dimensionality_insights?.clustering_analysis?.optimal_clusters }}</span>
                    </div>
                    <div class="metric-item">
                      <span class="metric-label">Clustering Quality:</span>
                      <span class="metric-value">{{ basicResults?.dimensionality_insights?.clustering_analysis?.clustering_recommendation }}</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recommendations -->
              <div class="dimensionality-section" *ngIf="basicResults?.dimensionality_insights?.recommendations?.length > 0">
                <h3>
                  <mat-icon>recommend</mat-icon>
                  Dimensionality Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults?.dimensionality_insights?.recommendations" class="recommendation-item">
                    <mat-icon>arrow_forward</mat-icon>
                    <span>{{ recommendation }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Baseline Model Sanity -->
          <mat-card *ngIf="basicResults?.baseline_model_sanity" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>model_training</mat-icon>
                Baseline Model Sanity Check
              </mat-card-title>
              <mat-card-subtitle>Data readiness assessment for machine learning modeling</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Readiness Score -->
              <div class="model-readiness-section">
                <h3>
                  <mat-icon>speed</mat-icon>
                  Model Readiness Assessment
                </h3>
                
                <div class="readiness-score-display">
                  <div class="score-circle" [ngClass]="getReadinessScoreClass(basicResults?.baseline_model_sanity?.readiness_score || 0)">
                    <span class="score-value">{{ basicResults?.baseline_model_sanity?.readiness_score | number:'1.0-0' }}%</span>
                    <span class="score-label">Ready</span>
                  </div>
                </div>
                
                <div class="readiness-factors">
                  <div class="factor-item" *ngFor="let factor of getReadinessFactorsArray()">
                    <span class="factor-label">{{ factor.key | titlecase }}:</span>
                    <div class="factor-bar">
                      <div class="factor-fill" [style.width.%]="factor.value"></div>
                    </div>
                    <span class="factor-value">{{ factor.value | number:'1.0-0' }}%</span>
                  </div>
                </div>
              </div>

              <!-- Target Suggestions -->
              <div class="model-section" *ngIf="basicResults?.baseline_model_sanity?.target_suggestions?.length > 0">
                <h3>
                  <mat-icon>adjust</mat-icon>
                  Target Variable Suggestions
                </h3>
                
                <div class="target-suggestions-grid">
                  <div *ngFor="let target of basicResults?.baseline_model_sanity?.target_suggestions" class="target-card">
                    <h4>{{ target.column }}</h4>
                    <div class="target-info">
                      <mat-chip [color]="target.type === 'regression' ? 'primary' : 'accent'" selected>
                        {{ target.type | titlecase }}
                      </mat-chip>
                      <span class="target-reason">{{ target.reason }}</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Preprocessing Recommendations -->
              <div class="model-section" *ngIf="basicResults?.baseline_model_sanity?.preprocessing_recommendations?.length > 0">
                <h3>
                  <mat-icon>build</mat-icon>
                  Preprocessing Steps
                </h3>
                
                <div class="preprocessing-list">
                  <div *ngFor="let step of basicResults?.baseline_model_sanity?.preprocessing_recommendations" class="preprocessing-item">
                    <mat-icon>check_circle</mat-icon>
                    <span>{{ step }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Bias/Fairness Flags -->
          <mat-card *ngIf="basicResults?.bias_fairness_flags" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>balance</mat-icon>
                Bias & Fairness Assessment
              </mat-card-title>
              <mat-card-subtitle>Detect potential bias and fairness issues in the dataset</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Bias Risk Level -->
              <div class="bias-summary-section">
                <h3>
                  <mat-icon>report</mat-icon>
                  Overall Bias Risk Assessment
                </h3>
                
                <div class="bias-risk-display">
                  <mat-chip [color]="getBiasRiskColor(basicResults?.bias_fairness_flags?.bias_risk_level || 'low')" selected>
                    {{ basicResults?.bias_fairness_flags?.bias_risk_level | titlecase }} Risk
                  </mat-chip>
                </div>
              </div>

              <!-- Sensitive Attributes -->
              <div class="bias-section" *ngIf="basicResults?.bias_fairness_flags?.potential_sensitive_attributes?.length > 0">
                <h3>
                  <mat-icon>visibility_off</mat-icon>
                  Potential Sensitive Attributes
                </h3>
                
                <div class="sensitive-attributes-grid">
                  <div *ngFor="let attr of basicResults?.bias_fairness_flags?.potential_sensitive_attributes" class="sensitive-attr-card">
                    <h4>{{ attr.column }}</h4>
                    <div class="attr-details">
                      <mat-chip color="warn" selected>{{ attr.type | titlecase }}</mat-chip>
                      <span class="unique-count">{{ attr.unique_values }} unique values</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Class Imbalance -->
              <div class="bias-section" *ngIf="getClassImbalanceArray().length > 0">
                <h3>
                  <mat-icon>donut_small</mat-icon>
                  Class Imbalance Analysis
                </h3>
                
                <div class="imbalance-grid">
                  <div *ngFor="let imbalance of getClassImbalanceArray()" class="imbalance-card">
                    <h4>{{ imbalance.key }}</h4>
                    <div class="imbalance-details">
                      <div class="imbalance-ratio">
                        Ratio: {{ imbalance.value.imbalance_ratio | number:'1.1-1' }}:1
                      </div>
                      <div class="majority-class">
                        Majority: {{ imbalance.value.majority_class }} ({{ imbalance.value.majority_percentage | number:'1.1-1' }}%)
                      </div>
                      <mat-chip [color]="imbalance.value.severity === 'severe' ? 'warn' : 'accent'" selected>
                        {{ imbalance.value.severity | titlecase }}
                      </mat-chip>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recommendations -->
              <div class="bias-section" *ngIf="basicResults?.bias_fairness_flags?.recommendations?.length > 0">
                <h3>
                  <mat-icon>gavel</mat-icon>
                  Fairness Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults?.bias_fairness_flags?.recommendations" class="recommendation-item">
                    <mat-icon>arrow_forward</mat-icon>
                    <span>{{ recommendation }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Drift/Stability Analysis -->
          <mat-card *ngIf="basicResults?.drift_stability_analysis" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>trending_flat</mat-icon>
                Drift/Stability Analysis
              </mat-card-title>
              <mat-card-subtitle>Analyze data stability and detect potential drift indicators</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Overall Stability Assessment -->
              <div class="stability-summary-section" *ngIf="basicResults?.drift_stability_analysis?.overall_assessment">
                <h3>
                  <mat-icon>tune</mat-icon>
                  Overall Stability Assessment
                </h3>
                
                <div class="stability-score-display">
                  <div class="score-circle" [ngClass]="getStabilityScoreClass(basicResults?.drift_stability_analysis?.overall_assessment?.stability_score || 0)">
                    <span class="score-value">{{ basicResults?.drift_stability_analysis?.overall_assessment?.stability_score | number:'1.0-0' }}%</span>
                    <span class="score-label">Stable</span>
                  </div>
                </div>
                
                <div class="assessment-details">
                  <div class="detail-item">
                    <span class="detail-label">Risk Level:</span>
                    <mat-chip [color]="getDriftRiskColor(basicResults?.drift_stability_analysis?.overall_assessment?.risk_level || 'low')" selected>
                      {{ basicResults?.drift_stability_analysis?.overall_assessment?.risk_level | titlecase }}
                    </mat-chip>
                  </div>
                  <div class="detail-item">
                    <span class="detail-label">Drift Indicators:</span>
                    <span class="detail-value">{{ basicResults?.drift_stability_analysis?.overall_assessment?.drift_indicators_count || 0 }}</span>
                  </div>
                </div>
              </div>

              <!-- Statistical Stability Tests -->
              <div class="stability-tests-section" *ngIf="basicResults?.drift_stability_analysis?.statistical_tests?.length > 0">
                <h3>
                  <mat-icon>science</mat-icon>
                  Statistical Stability Tests
                </h3>
                
                <div class="tests-grid">
                  <div *ngFor="let test of basicResults?.drift_stability_analysis?.statistical_tests" class="test-card">
                    <h4>{{ test.test_name }}</h4>
                    <div class="test-result">
                      <mat-chip [color]="test.is_stable ? 'primary' : 'warn'" selected>
                        {{ test.is_stable ? 'Stable' : 'Unstable' }}
                      </mat-chip>
                    </div>
                    <div class="test-details">
                      <div class="test-metric">
                        <span class="metric-label">P-value:</span>
                        <span class="metric-value">{{ test.p_value | number:'1.4-4' }}</span>
                      </div>
                      <div class="test-metric">
                        <span class="metric-label">Statistic:</span>
                        <span class="metric-value">{{ test.statistic | number:'1.4-4' }}</span>
                      </div>
                    </div>
                    <div class="test-interpretation">
                      {{ test.interpretation }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Column-wise Drift Analysis -->
              <div class="column-drift-section" *ngIf="getColumnDriftArray().length > 0">
                <h3>
                  <mat-icon>view_column</mat-icon>
                  Column-wise Drift Analysis
                </h3>
                
                <div class="drift-columns-grid">
                  <div *ngFor="let column of getColumnDriftArray()" class="drift-column-card">
                    <h4>{{ column.column }}</h4>
                    <div class="drift-status">
                      <mat-chip [color]="column.drift_detected ? 'warn' : 'primary'" selected>
                        {{ column.drift_detected ? 'Drift Detected' : 'Stable' }}
                      </mat-chip>
                    </div>
                    <div class="drift-metrics">
                      <div class="metric-item">
                        <span class="metric-label">Drift Score:</span>
                        <span class="metric-value">{{ column.drift_score | number:'1.3-3' }}</span>
                      </div>
                      <div class="metric-item">
                        <span class="metric-label">Method:</span>
                        <span class="metric-value">{{ column.detection_method }}</span>
                      </div>
                    </div>
                    <div class="drift-details" *ngIf="column.details">
                      {{ column.details }}
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recommendations -->
              <div class="stability-recommendations-section" *ngIf="basicResults?.drift_stability_analysis?.recommendations?.length > 0">
                <h3>
                  <mat-icon>lightbulb</mat-icon>
                  Stability Recommendations
                </h3>
                
                <div class="recommendations-list">
                  <div *ngFor="let recommendation of basicResults?.drift_stability_analysis?.recommendations" class="recommendation-item">
                    <mat-icon>arrow_forward</mat-icon>
                    <span>{{ recommendation }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Reproducibility Info -->
          <mat-card *ngIf="basicResults?.reproducibility_info" class="result-card">
            <mat-card-header>
              <mat-card-title>
                <mat-icon>assignment_turned_in</mat-icon>
                Reproducibility Information
              </mat-card-title>
              <mat-card-subtitle>Complete environment and analysis reproducibility details</mat-card-subtitle>
            </mat-card-header>
            
            <mat-card-content>
              <!-- Environment Details -->
              <div class="reproducibility-section" *ngIf="basicResults?.reproducibility_info?.environment">
                <h3>
                  <mat-icon>computer</mat-icon>
                  Environment Details
                </h3>
                
                <div class="environment-grid">
                  <div class="env-item">
                    <span class="env-label">Python Version:</span>
                    <span class="env-value">{{ basicResults?.reproducibility_info?.environment?.python_version }}</span>
                  </div>
                  <div class="env-item">
                    <span class="env-label">Platform:</span>
                    <span class="env-value">{{ basicResults?.reproducibility_info?.environment?.platform }}</span>
                  </div>
                  <div class="env-item">
                    <span class="env-label">Analysis Timestamp:</span>
                    <span class="env-value">{{ basicResults?.reproducibility_info?.environment?.timestamp | date:'medium' }}</span>
                  </div>
                  <div class="env-item">
                    <span class="env-label">Random Seed:</span>
                    <span class="env-value">{{ basicResults?.reproducibility_info?.environment?.random_seed }}</span>
                  </div>
                </div>
              </div>

              <!-- Package Versions -->
              <div class="reproducibility-section" *ngIf="basicResults?.reproducibility_info?.package_versions">
                <h3>
                  <mat-icon>extension</mat-icon>
                  Package Versions
                </h3>
                
                <div class="packages-grid">
                  <div *ngFor="let package of getPackageVersionsArray()" class="package-item">
                    <span class="package-name">{{ package.key }}</span>
                    <span class="package-version">{{ package.value }}</span>
                  </div>
                </div>
              </div>

              <!-- Analysis Configuration -->
              <div class="reproducibility-section" *ngIf="basicResults?.reproducibility_info?.analysis_config">
                <h3>
                  <mat-icon>settings</mat-icon>
                  Analysis Configuration
                </h3>
                
                <div class="config-details">
                  <div class="config-item" *ngFor="let config of getAnalysisConfigArray()">
                    <span class="config-label">{{ config.key | titlecase }}:</span>
                    <span class="config-value">{{ config.value }}</span>
                  </div>
                </div>
              </div>

              <!-- Data Fingerprint -->
              <div class="reproducibility-section" *ngIf="basicResults?.reproducibility_info?.data_fingerprint">
                <h3>
                  <mat-icon>fingerprint</mat-icon>
                  Data Fingerprint
                </h3>
                
                <div class="fingerprint-details">
                  <div class="fingerprint-item">
                    <span class="fingerprint-label">Data Hash:</span>
                    <code class="fingerprint-value">{{ basicResults?.reproducibility_info?.data_fingerprint?.data_hash }}</code>
                  </div>
                  <div class="fingerprint-item">
                    <span class="fingerprint-label">Schema Hash:</span>
                    <code class="fingerprint-value">{{ basicResults?.reproducibility_info?.data_fingerprint?.schema_hash }}</code>
                  </div>
                  <div class="fingerprint-item">
                    <span class="fingerprint-label">Row Count:</span>
                    <span class="fingerprint-value">{{ basicResults?.reproducibility_info?.data_fingerprint?.row_count | number }}</span>
                  </div>
                  <div class="fingerprint-item">
                    <span class="fingerprint-label">Column Count:</span>
                    <span class="fingerprint-value">{{ basicResults?.reproducibility_info?.data_fingerprint?.column_count | number }}</span>
                  </div>
                </div>
              </div>

              <!-- Reproduction Instructions -->
              <div class="reproducibility-section" *ngIf="basicResults?.reproducibility_info?.reproduction_instructions?.length > 0">
                <h3>
                  <mat-icon>list_alt</mat-icon>
                  Reproduction Instructions
                </h3>
                
                <div class="instructions-list">
                  <div *ngFor="let instruction of basicResults?.reproducibility_info?.reproduction_instructions; let i = index" class="instruction-item">
                    <span class="step-number">{{ i + 1 }}.</span>
                    <span class="instruction-text">{{ instruction }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>

<!-- No Dataset Message -->
<div class="no-dataset" *ngIf="!currentDataset">
  <mat-card>
    <mat-card-content>
      <div class="no-dataset-content">
        <mat-icon class="no-dataset-icon">upload_file</mat-icon>
        <h2>No Dataset Selected</h2>
        <p>Please upload a dataset first to perform statistical analysis.</p>
        <button mat-raised-button color="primary" routerLink="/upload">
          <mat-icon>upload</mat-icon>
          Upload Dataset
        </button>
      </div>
    </mat-card-content>
  </mat-card>
</div>
